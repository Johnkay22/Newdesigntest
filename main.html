<html>
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R1E17DCKNC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-R1E17DCKNC');
</script>
<base href="https://www.poopprofit.com/index.html">
<title>How Much You Make to Poop!</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    /* Existing CSS here... */
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1 class="neon-text">Poop Profit Calculator</h1>
        <div class="card glow">
            <label for="calcMethod">Choose Calculation Method:</label>
            <select id="calcMethod">
                <option value="salary">Salary & Hours</option>
                <option value="hourlyWage">Hourly Wage</option>
            </select>
            <div id="salaryInputs">
                <input type="number" id="salary" placeholder="Annual Salary">
                <input type="number" id="hoursPerWeek" placeholder="Weekly Work Hours">
            </div>
            <div id="hourlyWageInput" style="display: none;">
                <input type="number" id="hourlyWage" placeholder="Hourly Wage">
            </div>
            <div id="result"></div>
        </div>
        <div class="card glow">
            <div id="poopEmoji">ðŸ’©</div>
            <div id="timer" class="neon-text">00:00:00</div>
            <button id="startStopButton">Start Pooping</button>
        </div>
        <div class="card glow">
            <h2>Poop Log</h2>
            <div id="log">
                <div id="logEntries"></div>
            </div>
        </div>
        <button id="statsButton">Show Statistics</button>
        <button id="logoutButton">Logout</button>
    </div>

    <div id="ratingModal" class="modal">
        <!-- Existing Modal Content Here -->
    </div>

    <script>
        let timer;
        let seconds = 0;
        let isRunning = false;
        let currentUser = JSON.parse(localStorage.getItem('currentUser'));
        let poopRating = 0;
        let currentShareIndex = -1;
        let lastSessionEarnings = 0;
        let statsChart = null;

        const calcMethod = document.getElementById('calcMethod');
        const salaryInputs = document.getElementById('salaryInputs');
        const hourlyWageInput = document.getElementById('hourlyWageInput');
        const salaryInput = document.getElementById('salary');
        const hoursPerWeekInput = document.getElementById('hoursPerWeek');
        const hourlyWageInputField = document.getElementById('hourlyWage');
        const resultDiv = document.getElementById('result');
        const timerDiv = document.getElementById('timer');
        const startStopButton = document.getElementById('startStopButton');
        const logDiv = document.getElementById('log');
        const logEntriesDiv = document.getElementById('logEntries');
        const statsButton = document.getElementById('statsButton');
        const poopEmoji = document.getElementById('poopEmoji');
        const logoutButton = document.getElementById('logoutButton');

        const ratingModal = document.getElementById('ratingModal');
        const poopButtons = ratingModal.querySelectorAll('.poop');
        const submitRatingButton = document.getElementById('submitRating');
        const closeButtons = document.querySelectorAll('.close');

        const statsModal = document.getElementById('statsModal');
        const shareModal = document.getElementById('shareModal');
        const shareRatingModal = document.getElementById('shareRatingModal');

        // Toggle between salary and hourly wage input
        calcMethod.addEventListener('change', function() {
            if (calcMethod.value === 'salary') {
                salaryInputs.style.display = 'block';
                hourlyWageInput.style.display = 'none';
            } else {
                salaryInputs.style.display = 'none';
                hourlyWageInput.style.display = 'block';
            }
        });

        // Existing timer functionality here...

        // Add a function to calculate earnings based on the chosen method
        function calculateEarnings() {
            let earningsPerSecond = 0;
            if (calcMethod.value === 'salary') {
                const salary = parseFloat(salaryInput.value);
                const hoursPerWeek = parseFloat(hoursPerWeekInput.value);
                if (salary > 0 && hoursPerWeek > 0) {
                    const weeklyEarnings = salary / 52;
                    earningsPerSecond = (weeklyEarnings / (hoursPerWeek * 3600));
                }
            } else if (calcMethod.value === 'hourlyWage') {
                const hourlyWage = parseFloat(hourlyWageInputField.value);
                if (hourlyWage > 0) {
                    earningsPerSecond = hourlyWage / 3600;
                }
            }
            return earningsPerSecond;
        }

        // Updated start/stop function with calculation
        startStopButton.addEventListener('click', function() {
            if (!isRunning) {
                timer = setInterval(() => {
                    seconds++;
                    updateTimer();
                    const earnings = calculateEarnings() * seconds;
                    resultDiv.textContent = `You've earned $${earnings.toFixed(2)} so far.`;
                }, 1000);
                isRunning = true;
                startStopButton.textContent = 'Stop Pooping';
            } else {
                clearInterval(timer);
                isRunning = false;
                startStopButton.textContent = 'Start Pooping';
                lastSessionEarnings = calculateEarnings() * seconds;
                saveSession();
            }
        });

        // Existing functions like updateTimer(), saveSession(), etc.

    </script>
</body>
</html>
